(function(e,a){var t=e(".ins-search"),l=t.find(".ins-search-input"),n=t.find(".ins-section-wrapper"),o=t.find(".ins-section-container");t.parent().remove(".ins-search"),e("body").append(t);function v(t){return e("<section>").addClass("ins-section").append(e("<header>").addClass("ins-section-header").text(t))}function c(o,t,n,s,i){return e("<div>").addClass("ins-selectable").addClass("ins-search-item").append(e("<header>").append(e("<i>").addClass("icon").addClass("icon-"+o)).append(t!=null&&t!=''?t:a.TRANSLATION.UNTITLED).append(n?e("<span>").addClass("ins-slug").text(n):null)).append(s?e("<p>").addClass("ins-search-preview").text(s):null).attr("data-url",i)}function b(e,t){var n,s;if(t.length===0)return null;switch(s=a.TRANSLATION[e],e){case"POSTS":n=t.map(function(e){return c("file",e.title,null,e.content.slice(0,150),e.uri)});break;case"CATEGORIES":case"TAGS":n=t.map(function(t){return c(e==="CATEGORIES"?"folder":"tag",t.title,'',null,t.uri)});break;default:return null}return v(s).append(n)}function d(e){return e.split(" ").filter(function(e){return!!e}).map(function(e){return e.toUpperCase()})}function s(n,e,s){var i=!1,t=d(n),o=t.filter(function(t){var n=s.filter(function(n){if(!e.hasOwnProperty(n))return!1;if(e[n].toUpperCase().indexOf(t)>-1)return!0});return n.length>0});return o.length===t.length}function h(e){return{POST:function(t){return s(e,t,["title","content"])},PAGE:function(t){return s(e,t,["title","content"])},CATEGORY:function(t){return s(e,t,["title"])},TAG:function(t){return s(e,t,["title"])}}}function i(n,e,s,o){var t=0;return d(n).forEach(function(n){var i=new RegExp(n,"img");s.forEach(function(n,a){if(e.hasOwnProperty(n)){var s=e[n].match(i);t+=s?s.length*o[a]:0}})}),t}function m(e){return{POST:function(t){return i(e,t,["title","content"],[3,1])},PAGE:function(t){return i(e,t,["title","content"],[3,1])},CATEGORY:function(t){return i(e,t,["title"],[1])},TAG:function(t){return i(e,t,["title"],[1])}}}function f(t,s){var e=m(s),n=h(s),o=t.posts,i=t.tags,a=t.categories;return{posts:o.filter(n.POST).sort(function(t,n){return e.POST(n)-e.POST(t)}).slice(0,5),categories:a.filter(n.CATEGORY).sort(function(t,n){return e.CATEGORY(n)-e.CATEGORY(t)}).slice(0,5),tags:i.filter(n.TAG).sort(function(t,n){return e.TAG(n)-e.TAG(t)}).slice(0,5)}}function p(e){o.empty();for(var t in e)o.append(b(t.toUpperCase(),e[t]))}function g(e){if(e.length===0)return;var s=n[0].clientHeight,o=e.position().top-n.scrollTop(),t=e[0].clientHeight+e.position().top;t>s+n.scrollTop()&&n.scrollTop(t-n[0].clientHeight),o<0&&n.scrollTop(e.position().top)}function r(i){var s,t=e.makeArray(o.find(".ins-selectable")),n=-1;t.forEach(function(t,s){if(e(t).hasClass("active")){n=s;return}}),s=(t.length+n+i)%t.length,e(t[n]).removeClass("active"),e(t[s]).addClass("active"),g(e(t[s]))}function u(e){e&&e.length&&(location.href=e.attr("data-url"))}e.getJSON(a.CONTENT_URL,function(n){location.hash.trim()==="#ins-search"&&t.addClass("show"),l.on("input",function(){var t=e(this).val();p(f(n,t))}),l.trigger("input")}),e(document).on("click focus",".search-form-input",function(){t.addClass("show"),t.find(".ins-search-input").focus()}).on("click",".ins-search-item",function(){u(e(this))}).on("click",".ins-close",function(){t.removeClass("show")}).on("keydown",function(e){if(!t.hasClass("show"))return;switch(e.keyCode){case 27:t.removeClass("show");break;case 38:r(-1);break;case 40:r(1);break;case 13:u(o.find(".ins-selectable.active").eq(0));break}})})(jQuery,window.INSIGHT_CONFIG)